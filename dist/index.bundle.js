!function(e){var t={};function r(n){if(t[n])return t[n].exports;var u=t[n]={i:n,l:!1,exports:{}};return e[n].call(u.exports,u,u.exports,r),u.l=!0,u.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.w={},r(r.s=26)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u={port:process.env.port||3410,version:"API v1.0.0"};t.default=n({},u,function(e){switch(e){case"development":return devConfig;case"production":return prodConfig;default:return devConfig}}("production"))},function(e,t){e.exports=require("mongoose")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),u=o(n),a=o(r(4)),s=o(r(0)),i=o(r(3));function o(e){return e&&e.__esModule?e:{default:e}}var l=new n.Schema({facebookId:{type:String,trim:!0,required:!0,index:{unique:!0},default:null},avatar:{type:String,default:null},name:{type:String,required:[!0,"Name cannot be empty"],trim:!0},skills:[{skill:{type:String,index:!0},rating:{type:Number,index:!0}}],friends:[{type:String,ref:"User"}],block:{type:Boolean,default:!1}},{timestamps:!0});l.methods={createToken:function(){return a.default.sign({_id:this._id,facebookId:this.facebookId},s.default.JWT_SECRET)},toJSON:function(){return{_id:this._id,skills:this.skills,name:this.name,avatar:this.avatar,token:"bearer "+this.createToken()}},toJSONSkills:function(){return{achievements:i.default.toArray(this.skills)}}},l.statics={list:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.skip,r=void 0===t?0:t,n=e.limit,u=void 0===n?50:n;return this.find().sort({createdAt:-1}).skip(+r).limit(+u).exec()},listBlocked:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.skip,r=void 0===t?0:t,n=e.limit,u=void 0===n?50:n;return this.find({block:!0}).sort({createdAt:-1}).skip(+r).limit(+u).exec()}},t.default=u.default.model("User",l)},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("passport")},function(e,t){e.exports=require("express")},function(e,t,r){"use strict";var n=a(r(1)),u=a(r(0));function a(e){return e&&e.__esModule?e:{default:e}}n.default.Promise=global.Promise,n.default.connect(u.default.MONGO_URL).then(console.log("\n                Connected to mongodb @ "+u.default.MONGO_URL+"\n    ")).catch(function(e){console.log("\n               Error occured when connecting to "+u.default.MONGO_URL+"\n               ERROR: "+e.message+"\n    ")})},function(e,t){e.exports=require("passport-facebook-token")},function(e,t){e.exports=require("passport-jwt")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.authFB=t.authJwt=void 0;var n=o(r(5)),u=r(9),a=o(r(8)),s=o(r(2)),i=o(r(0));function o(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(u,a){try{var s=t[u](a),i=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}("next")})}}var c,d,f={jwtFromRequest:u.ExtractJwt.fromAuthHeaderAsBearerToken("Authorization"),secretOrKey:i.default.JWT_SECRET},p=new u.Strategy(f,(c=l(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.prev=1,e.next=4,s.default.findById(t._id);case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",r(null,!1));case 7:return e.abrupt("return",r(null,n));case 10:return e.prev=10,e.t0=e.catch(1),console.log(e.t0.message),e.abrupt("return",r(e.t0,!1));case 14:case"end":return e.stop()}},e,void 0,[[1,10]])})),function(e,t){return c.apply(this,arguments)})),v=new a.default({ofileFields:["id","birthday","email","first_name","gender","last_name","profileUrl","picture.width(200).height(200)"]},(d=l(regeneratorRuntime.mark(function e(t,r,n,u){var a,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log(n),e.next=4,s.default.findOne({facebookId:n.id});case 4:if(!(a=e.sent)){e.next=14;break}return console.log("User exists"),i={name:n.displayName,avatar:n.photos[0].value},e.next=10,s.default.findByIdAndUpdate(a._id,i);case 10:a=e.sent,u(null,a),e.next=25;break;case 14:return o=new s.default({name:n.displayName,facebookId:n.id,avatar:n.photos[0].value}),e.prev=15,e.next=18,s.default.create(o);case 18:a=e.sent,u(null,a),e.next=25;break;case 22:return e.prev=22,e.t0=e.catch(15),e.abrupt("return",u(error,!1));case 25:e.next=30;break;case 27:return e.prev=27,e.t1=e.catch(0),e.abrupt("return",u(e.t1,!1));case 30:case"end":return e.stop()}},e,void 0,[[0,27],[15,22]])})),function(e,t,r,n){return d.apply(this,arguments)}));n.default.use(p),n.default.use(v);t.authJwt=n.default.authenticate("jwt",{session:!1}),t.authFB=n.default.authenticate("facebook-token",{session:!1})},function(e,t){e.exports=require("http-status")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeSkills=t.updateSkills=t.createSkills=t.getSkills=t.profile=void 0;var n,u,a,s,i;t.profile=(n=p(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{r.status(l.default.OK).json(t.user.toJSON())}catch(e){r.status(l.default.BAD_REQUEST).send()}case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)}),t.getSkills=(u=p(regeneratorRuntime.mark(function e(t,r){var n,u,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.headers.authorization.split(" ")[1],e.next=4,o.default.verify(n,c.default.JWT_SECRET);case 4:return u=e.sent,e.next=7,d.default.findById(u._id).select("skills").populate("skills");case 7:if(a=e.sent){e.next=10;break}return e.abrupt("return",r.status(l.default.NO_CONTENT).send());case 10:return e.next=12,a.toJSONSkills();case 12:s=e.sent,r.status(l.default.OK).json(s),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),r.status(l.default.BAD_REQUEST).send();case 19:case"end":return e.stop()}},e,this,[[0,16]])})),function(e,t){return u.apply(this,arguments)}),t.createSkills=(a=p(regeneratorRuntime.mark(function e(t,r){var n,u,a,s,i,f,p,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.headers.authorization.split(" ")[1],e.next=4,o.default.verify(n,c.default.JWT_SECRET);case 4:return u=e.sent,a=t.body.rating,s=t.body.skill,e.next=9,d.default.findById(u._id);case 9:if(i=e.sent,f=i.skills,p={skill:s,rating:a},f.push(p),v=d.default.findByIdAndUpdate(i._id,{skills:f})){e.next=16;break}return e.abrupt("return",r.status(l.default.NO_CONTENT).send());case 16:r.status(l.default.OK).json({skills:f,user:v}),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),r.status(l.default.BAD_REQUEST).send();case 22:case"end":return e.stop()}},e,this,[[0,19]])})),function(e,t){return a.apply(this,arguments)}),t.updateSkills=(s=p(regeneratorRuntime.mark(function e(t,r){var n,u,a,s,i,f,p,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.headers.authorization.split(" ")[1],e.next=4,o.default.verify(n,c.default.JWT_SECRET);case 4:return u=e.sent,a=t.body.rating,s=t.body.skill,e.next=9,d.default.findById(u._id);case 9:if(i=e.sent,f=i.skills,p={skill:s,rating:a},f.push(p),v=d.default.findByIdAndUpdate(i._id,{skills:f})){e.next=16;break}return e.abrupt("return",r.status(l.default.NO_CONTENT).send());case 16:r.status(l.default.OK).json({skills:f,user:v}),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),r.status(l.default.BAD_REQUEST).send();case 22:case"end":return e.stop()}},e,this,[[0,19]])})),function(e,t){return s.apply(this,arguments)}),t.removeSkills=(i=p(regeneratorRuntime.mark(function e(t,r){var n,u,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.headers.authorization.split(" ")[1],e.next=4,o.default.verify(n,c.default.JWT_SECRET);case 4:return u=e.sent,t.body.rating,t.body.skill,e.next=9,d.default.findById(u._id);case 9:if(a=e.sent,a.skills,a){e.next=13;break}return e.abrupt("return",r.status(l.default.NO_CONTENT).send());case 13:return e.next=15,a.toJSONSkills();case 15:s=e.sent,r.status(l.default.OK).json(s),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),r.status(l.default.BAD_REQUEST).send();case 22:case"end":return e.stop()}},e,this,[[0,19]])})),function(e,t){return i.apply(this,arguments)});t.fbLogin=function(e,t,r){return t.status(l.default.OK).json(e.user.toJSON()),r()};var o=f(r(4)),l=(f(r(3)),f(r(11))),c=f(r(0)),d=f(r(2));function f(e){return e&&e.__esModule?e:{default:e}}function p(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(u,a){try{var s=t[u](a),i=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}("next")})}}},function(e,t){e.exports=require("joi")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,u=r(13),a=(n=u)&&n.__esModule?n:{default:n};t.default={skills:{body:{skill:a.default.string().required(),rating:a.default.number().min(0).max(5).required()}}}},function(e,t){e.exports=require("express-validation")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),u=o(r(15)),a=o(r(14)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(12)),i=r(10);function o(e){return e&&e.__esModule?e:{default:e}}var l=(0,n.Router)();l.post("/auth/facebook",i.authFB,s.fbLogin),l.get("/",i.authJwt,s.profile),l.get("/skills",i.authJwt,s.getSkills),l.delete("/skills/:id",i.authJwt,s.removeSkills),l.put("/skills/:id",i.authJwt,s.updateSkills),l.post("/skills",[i.authJwt,(0,u.default)(a.default.skills)],s.createSkills),t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(16)),u=a(r(11));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){e.use("/api/v1/users",n.default),e.get("/",function(e,t){return t.status(u.default.OK).send({hello:"SKILLMASH"})})}},function(e,t){e.exports=require("compression")},function(e,t){e.exports=require("helmet")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("cors")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(r(22)),u=o(r(21)),a=(o(r(20)),o(r(5))),s=o(r(19)),i=o(r(18));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){e.use((0,n.default)()),e.use(u.default.json()),e.use(u.default.urlencoded({extended:!0})),e.use((0,i.default)()),e.use((0,s.default)()),e.use(a.default.initialize())}},function(e,t,r){"use strict";var n=i(r(6)),u=i(r(23)),a=i(r(17));r(7);var s=i(r(0));function i(e){return e&&e.__esModule?e:{default:e}}var o=(0,n.default)();(0,u.default)(o),(0,a.default)(o),o.listen(s.default.port,function(e){e?console.log(e.message):console.log("\n                 SKILLMASH IS RUNNING ON PORT "+s.default.port+"\n    ")})},function(e,t){e.exports=require("babel-polyfill")},function(e,t,r){r(25),e.exports=r(24)}]);